#简介
x86提供两种机制进行内存保护，一是分段机制，二是分页机制。
###分段机制
分段机制主要的目的是将代码段、数据段及堆栈段分开，保证相互之间不会干扰。同时也可以起到一定的保护作用，一是防止 访问超出段大小的内存，二是防止运行在堆栈中的恶意程序。

x86的段描述符表需要常驻内存，通过lgdt及sgdt来操作。

当程序中操作一个地址时，需要通过段映射才能得到虚拟地址，要所要访问的是代码段，数据段还是堆栈段，分别使用CS，DS和SS来作为段选择子，段选择子的作用就是指出当前段在段描述符表中的位置，找出对应的段描述符。段描述符中指出了当前段的基地址，段长度和一些权限等信息。基地址再加上指令中的地址才得到了实际要访问的虚拟地址。

进入保护模式就默认开启的分段机制。
###分页机制
分页，分页是为了实现虚拟内存。虚拟内存好处很多：

1. 让每个程序都认为自己独占计算机的内存空间，概念清晰，方便程序的编译及装载。
2. 通过将部分内存暂存在磁盘上，可以让程序可以使用比物理内存大的多的虚拟内存，突破物理内存的限制。
3. 通过对不同进程设置不同的页表，可以防止进程访问其它的进程的地址空间。通过在不同进程之间映射相同的物理页，又可以提供进程之间的共享。

x86使用两级页表，用虚拟地址的高10位索引第一级页表(页目录)，找出第二级页表在内存中的起始地址。再使用11-20位索引第二级页表，找出最终的页表项，即可找到虚拟地址最终映射的物理地址(高20位)，再跟虚拟地址的低12位组合起来形成32位的物理地址。

页表项的低12位指出了当前项是否有效及一些权限等信息。

分页机制要在分段机制开启的基础上开启，也可以不开启。

以上纯粹是我个人的理解，可能会有错误。如果要看详细的，还是去看Intel的资料吧，虽然我是看赵炯博士的书学习的。

#参考资料
1. [old linux](http://oldlinux.org/)
2. [intel manual](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)
